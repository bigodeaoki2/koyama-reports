(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{fJYE:function(e,t,s){"use strict";s.d(t,"a",(function(){return l}));var o=s("2Vo4"),r=s("lJxs"),a=s("fXoL"),i=s("6233");let l=(()=>{class e{constructor(e){this.db=e,this.Pushed=new o.a(!1)}getReports(){return this.db.list("reports").snapshotChanges().pipe(Object(r.a)(e=>e.map(e=>({info:e.payload.val(),key:e.payload.key}))))}getReportsCount(){return this.db.list("entries").valueChanges()}getReportsList(){return this.db.list("list").valueChanges()}editField(e,t,s){return this.db.object("reports/"+e+"/imovel/"+t.path).update(s)}removeImg(e,t,s){return this.db.object("reports/"+e+"/imovel/"+t).update(s)}getErrorReport(){return this.db.list("backup/imgs").snapshotChanges().pipe(Object(r.a)(e=>e.map(e=>e.payload.val())))}editReport(e,t,s){let o,r,a,i,l="reports/"+t,n="reports/"+s;this.db.list("reports/"+e).valueChanges().subscribe(e=>{o=e,this.db.list(l).valueChanges().subscribe(e=>{r=e,i=this.setNewObj(o,r),""!=s?this.db.list(n).valueChanges().subscribe(e=>{a=e,i=this.setNewObj(i,a),this.pushNewEntry(i)}):this.pushNewEntry(i)})})}setNewObj(e,t){for(let s=0;s<t[0].categorias.length;s++)e[0].categorias.push(t[0].categorias[s]);return e}pushNewEntry(e){let t={imovel:e[0]};t.imovel.id="Relatorio - "+t.imovel.id;const s=this.db.list("/reports").push(t);let o={corretor:t.imovel.corretor,data:t.imovel.data,id:s.key,imovel:t.imovel.corretor};this.db.list("/list").push(o)}deleteCategory(e,t){let s;this.db.list("/reports/"+e).valueChanges().subscribe(o=>{s=o,s[0].categorias.splice(t,1);let r={imovel:s[0]};return this.db.object("/reports/"+e).update(r)})}createReport(e){var t=new Date(e.value.date),s=t.getDate().toString().padStart(2,"0"),o=(t.getMonth()+1).toString().padStart(2,"0"),r=t.getFullYear();const a={imovel:{corretor:e.value.corretor,idImovel:e.value.id,data:s+"/"+o+"/"+r,imovel:e.value.endereco,status:e.value.status,obs:"",categorias:[]}};console.dir(a);const i=this.db.list("/reports").push(a);let l={corretor:e.value.corretor,data:s+"/"+o+"/"+r,id:i.key,imovel:e.value.endereco,idImovel:e.value.id};this.db.list("/list").push(l).then(()=>{this.Pushed.next(!0)})}addCategory(e,t){const s=[];if(t.info.imovel.categorias)for(let o=0;o<t.info.imovel.categorias.length;o++)s.push(t.info.imovel.categorias[o]);return s.push({nome:e.value.title,entradas:[]}),this.db.object("reports/"+t.key+"/imovel/categorias").update(s)}addComodo(e,t,s){const o=[];if(t.info.imovel.categorias[s].entradas)for(let r=0;r<t.info.imovel.categorias[s].entradas.length;r++)o.push(t.info.imovel.categorias[s].entradas[r]);return o.push({nome:e.value.comodo}),this.db.object("reports/"+t.key+"/imovel/categorias/"+s+"/entradas/").update(o)}}return e.\u0275fac=function(t){return new(t||e)(a.Tb(i.AngularFireDatabase))},e.\u0275prov=a.Gb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}]);